Namespace(arch='resnet50', batch_size=32, bottleneck_dim=256, data='Optical_ISAR', epochs=20, iters_per_epoch=1000, log='logs/adda/optical-isar', lr=0.001, lr_decay=0.75, lr_gamma=0.0003, momentum=0.9, no_hflip=False, no_pool=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), per_class_eval=False, phase='analysis', pretrain='logs/adda/optical-isar/checkpoints/best.pth', pretrain_epochs=3, pretrain_lr=0.001, print_freq=100, ratio=[0.75, 1.3333333333333333], resize_size=224, root='data/optical-isar', scale=[0.08, 1.0], scratch=False, seed=1, source=['o'], target=['i'], train_resizing='default', val_resizing='default', weight_decay=0.001, workers=2)
examples/domain_adaptation/image_classification/adda.py:52: UserWarning: You have chosen to seed training. This will turn on the CUDNN deterministic setting, which can slow down your training considerably! You may see unexpected behavior when restarting from checkpoints.
  warnings.warn('You have chosen to seed training. '
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomResizedCrop(size=(224, 224), scale=(0.08, 1.0), ratio=(0.75, 1.3333), interpolation=bilinear)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
=> using model 'resnet50'
  0%|                                                                                                                                    | 0/45 [00:00<?, ?it/s]  2%|##7                                                                                                                         | 1/45 [00:07<05:37,  7.67s/it]  7%|########2                                                                                                                   | 3/45 [00:07<01:26,  2.05s/it] 11%|#############7                                                                                                              | 5/45 [00:07<00:41,  1.04s/it] 16%|###################2                                                                                                        | 7/45 [00:08<00:26,  1.44it/s] 20%|########################8                                                                                                   | 9/45 [00:09<00:19,  1.83it/s] 24%|##############################                                                                                             | 11/45 [00:09<00:16,  2.04it/s] 29%|###################################5                                                                                       | 13/45 [00:10<00:13,  2.40it/s] 33%|#########################################                                                                                  | 15/45 [00:11<00:12,  2.38it/s] 38%|##############################################4                                                                            | 17/45 [00:11<00:11,  2.54it/s] 42%|###################################################9                                                                       | 19/45 [00:12<00:10,  2.54it/s] 47%|#########################################################4                                                                 | 21/45 [00:13<00:08,  2.91it/s] 51%|##############################################################8                                                            | 23/45 [00:13<00:06,  3.26it/s] 56%|####################################################################3                                                      | 25/45 [00:14<00:06,  3.27it/s] 60%|#########################################################################8                                                 | 27/45 [00:14<00:04,  3.74it/s] 64%|###############################################################################2                                           | 29/45 [00:15<00:04,  3.80it/s] 69%|####################################################################################7                                      | 31/45 [00:15<00:03,  4.30it/s] 71%|#######################################################################################4                                   | 32/45 [00:15<00:02,  4.55it/s] 73%|##########################################################################################1                                | 33/45 [00:15<00:02,  4.20it/s] 76%|############################################################################################9                              | 34/45 [00:16<00:02,  4.30it/s] 80%|##################################################################################################4                        | 36/45 [00:16<00:02,  3.77it/s] 84%|#######################################################################################################8                   | 38/45 [00:17<00:01,  3.57it/s] 87%|##########################################################################################################6                | 39/45 [00:17<00:01,  3.45it/s] 89%|#############################################################################################################3             | 40/45 [00:18<00:01,  2.69it/s] 93%|##################################################################################################################8        | 42/45 [00:18<00:01,  2.89it/s] 98%|########################################################################################################################2  | 44/45 [00:19<00:00,  3.56it/s]100%|###########################################################################################################################| 45/45 [00:19<00:00,  2.30it/s]
  0%|                                                                                                                                    | 0/35 [00:00<?, ?it/s]  3%|###5                                                                                                                        | 1/35 [00:04<02:21,  4.17s/it]  9%|##########6                                                                                                                 | 3/35 [00:04<00:35,  1.12s/it] 14%|#################7                                                                                                          | 5/35 [00:04<00:17,  1.74it/s] 20%|########################8                                                                                                   | 7/35 [00:04<00:09,  2.81it/s] 26%|###############################8                                                                                            | 9/35 [00:04<00:06,  4.11it/s] 31%|######################################6                                                                                    | 11/35 [00:04<00:04,  5.55it/s] 37%|#############################################6                                                                             | 13/35 [00:04<00:03,  7.15it/s] 43%|####################################################7                                                                      | 15/35 [00:04<00:02,  8.84it/s] 49%|###########################################################7                                                               | 17/35 [00:05<00:01, 10.21it/s] 54%|##################################################################7                                                        | 19/35 [00:05<00:01, 11.61it/s] 60%|#########################################################################8                                                 | 21/35 [00:05<00:01, 12.93it/s] 66%|################################################################################8                                          | 23/35 [00:05<00:00, 14.10it/s] 71%|#######################################################################################8                                   | 25/35 [00:05<00:00, 14.88it/s] 77%|##############################################################################################8                            | 27/35 [00:05<00:00, 15.53it/s] 83%|#####################################################################################################9                     | 29/35 [00:05<00:00, 15.97it/s] 89%|############################################################################################################9              | 31/35 [00:05<00:00, 16.37it/s] 94%|###################################################################################################################9       | 33/35 [00:06<00:00, 16.79it/s]100%|###########################################################################################################################| 35/35 [00:06<00:00, 16.75it/s]100%|###########################################################################################################################| 35/35 [00:06<00:00,  5.43it/s]
C:\Users\Keck\anaconda3\envs\tllib\lib\site-packages\sklearn\manifold\_t_sne.py:783: FutureWarning: The default initialization in TSNE will change from 'random' to 'pca' in 1.2.
  FutureWarning,
C:\Users\Keck\anaconda3\envs\tllib\lib\site-packages\sklearn\manifold\_t_sne.py:793: FutureWarning: The default learning rate in TSNE will change from 200.0 to 'auto' in 1.2.
  FutureWarning,
Saving t-SNE to logs/adda/optical-isar\visualize\TSNE.png
epoch 0 accuracy: 100.0 A-dist: 2.0
epoch 1 accuracy: 100.0 A-dist: 2.0
epoch 2 accuracy: 100.0 A-dist: 2.0
epoch 3 accuracy: 100.0 A-dist: 2.0
epoch 4 accuracy: 100.0 A-dist: 2.0
epoch 5 accuracy: 100.0 A-dist: 2.0
epoch 6 accuracy: 100.0 A-dist: 2.0
epoch 7 accuracy: 100.0 A-dist: 2.0
epoch 8 accuracy: 100.0 A-dist: 2.0
epoch 9 accuracy: 100.0 A-dist: 2.0
A-distance = tensor(2., device='cuda:0')
